# Loading
discord_impact_load = {
	set_local_variable = {
		name = discord_impact_option_$OPTION$_var
		value = $VALUE$
	}
}

# Modifiers
discord_impact_modifier_approval_x_ig = {
	if = {
		limit = {
			has_local_variable = discord_impact_option_$OPTION$_var
		}
		save_temporary_scope_value_as = {
			name = ig_approval_x_clout
			value = {
				value = $IG$.ig_approval
				add = 100
				multiply = {
					value = 1
					add = $IG$.ig_clout
				}
				divide = 100
			}
		}
		if = {
			limit = {
				$APPROVAL_ADD$ >= 6
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = monumental_discord_loss
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$APPROVAL_ADD$ >= 5
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = massive_discord_loss
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$APPROVAL_ADD$ >= 4
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = major_discord_loss
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$APPROVAL_ADD$ >= 3
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = medium_discord_loss
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$APPROVAL_ADD$ >= 2
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = minor_discord_loss
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$APPROVAL_ADD$ >= 0
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = miniscule_discord_loss
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$APPROVAL_ADD$ <= -6
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = monumental_discord_gain
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$APPROVAL_ADD$ <= -5
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = massive_discord_gain
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$APPROVAL_ADD$ <= -4
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = major_discord_gain
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$APPROVAL_ADD$ <= -3
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = medium_discord_gain
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$APPROVAL_ADD$ <= -2
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = minor_discord_gain
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$APPROVAL_ADD$ < 0
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = miniscule_discord_gain
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
	}
}

discord_impact_modifier_enactment_chance_x_ig = {
	if = {
		limit = {
			has_local_variable = discord_impact_option_$OPTION$_var
		}
		save_temporary_scope_value_as = {
			name = ig_approval_x_clout
			value = {
				value = $IG$.ig_approval
				add = 100
				multiply = {
					value = 1
					add = $IG$.ig_clout
				}
				divide = 100
			}
		}
		if = {
			limit = {
				$CHANCE$ >= 30
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = monumental_discord_loss
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$CHANCE$ >= 25
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = massive_discord_loss
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$CHANCE$ >= 20
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = major_discord_loss
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$CHANCE$ >= 15
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = medium_discord_loss
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$CHANCE$ >= 10
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = minor_discord_loss
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$CHANCE$ >= 0
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = miniscule_discord_loss
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$CHANCE$ <= -30
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = monumental_discord_gain
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$CHANCE$ <= -25
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = massive_discord_gain
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$CHANCE$ <= -20
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = major_discord_gain
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$CHANCE$ <= -15
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = medium_discord_gain
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$CHANCE$ <= -10
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = minor_discord_gain
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
		else_if = {
			limit = {
				$CHANCE$ < 0
			}
			discord_change_impact_by_value_and_multiplier = {
				OPTION = $OPTION$
				VALUE = miniscule_discord_gain
				MULTIPLIER = scope:ig_approval_x_clout
			}
		}
	}
}

discord_impact_country_modifiers = {
	if = {
		limit = {
			has_local_variable = discord_impact_option_$OPTION$_var
		}
		switch = {
			trigger = $TRAIT$
			"country_major_power_or_above" = {
				if = {
					limit = {
						country_rank >= rank_value:major_power
					}
					discord_change_impact_by_multiplier = {
						OPTION = $OPTION$
						MULTIPLIER = $MULTIPLIER$
					}
				}
			}
			"country_minor_power_or_below" = {
				if = {
					limit = {
						country_rank < rank_value:major_power
					}
					discord_change_impact_by_multiplier = {
						OPTION = $OPTION$
						MULTIPLIER = $MULTIPLIER$
					}
				}
			}
		}
	}
}

# Execute
discord_impact_execute = {
	change_discord = {
		VALUE = local_var:discord_impact_option_$OPTION$_var
	}
}

discord_change_impact_by_multiplier = {
	# Doesn't shorten code, but allows me to quickly change it around "globally"
	change_local_variable = {
		name = discord_impact_option_$OPTION$_var
		multiply = $MULTIPLIER$
	}
}

discord_change_impact_by_value = {
	# Doesn't shorten code, but allows me to quickly change it around "globally"
	change_local_variable = {
		name = discord_impact_option_$OPTION$_var
		add = $VALUE$
	}
}

discord_change_impact_by_value_and_multiplier = {
	# Doesn't shorten code, but allows me to quickly change it around "globally"
	change_local_variable = {
		name = discord_impact_option_$OPTION$_var
		add = {
			value = $VALUE$
			multiply = $MULTIPLIER$
		}
	}
}
